# ゲームボーイで動くプログラムを書いてみる

## 06. キー入力に反応してみる その1

さて、せっかくゲームボーイにはボタンが付いていますので、操作に反応して文字の表示をしてみましょう。


### Aボタンを押すと文字が出る
最初は、Aボタンを押すたびに「PUSH A」と表示されるプログラムです。

```c
#include <stdio.h>
#include <gb/gb.h>

int main() {
    UINT8 joypad_result;

    while(1) {
        joypad_result = joypad();

        if (joypad_result == J_A) {
            printf("PUSH A\n");
        }
    }
}
```

実行してAボタンを押すとこうなります。  

![](https://i.imgur.com/axSlaDU.png)

### コード解説
#### include
このコードでは座標指定をした文字出力を行っていないので、gb/drawing.hは使っていません。  
その代わりprintfのためのstdio.hと、ボタンを扱うためのgb/gb.hをincludeしています。

#### UINT8 joypad_result;
UINT8型のjoypad_resultという変数宣言です。(そういうものだと思ってください。)  
この変数にはどのボタンを押したのかの値が代入されます。

#### while(1){}
無限ループです、ゲームボーイの電源が消されるまで、永遠に{}内の処理が繰り返し実行されます。~~逮捕されないようにしましょう~~

#### joypad_result = joypad();
joypad()という関数で、どのボタンが押されているのかを取得することが可能です。その関数から出てきた結果を、joypad_resultという変数に保存しています。

#### if (joypad_result == J_A) {}
一つ前の`joypad_result = joypad();`の結果がAボタンだったら・・・というif文です。

#### printf("PUSH A\n");
これは特に説明の必要ないですね。文を表示して改行するだけです。


**この後は、if文が扱える場合に進んでください**  
if文がイマイチわからない場合は、[]に進み、if文を習得後にまたこの講座をやってみてくださいね。

### 実践2 (Aボタンが押されたら文字が出て、離されていたら文字を消す)

先程は押された判定の間ずっと文字が出ていて、そのままどんどん追記されていきました。  
次は、前の章で使った`gprintf`を使って、ボタンが押されている間だけ文字を表示してみましょう。

まずはどんな感じで作るかを想像してみましょう。  
使う要素は、

- while(1)
- joypad()
- gotogxy
- gprintf

くらいかと思います。では、それを踏まえて、コードを書いてみましょう。

ヒント: 文字を消す→空白で上書きする

[07. 実践2の解答例と実践3 ->](07.md)