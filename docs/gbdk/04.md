# ゲームボーイで動くプログラムを書いてみる

## 04. 決めた場所に文字を出す

先程の章では、普通にprintfを使いました。でもこのままではいくらprintfしようが文字を変えようが、常に左上から順に文字が表示されていくだけです。  
では次に、画面内の指定した位置に文字を出してみましょう。

(この章は、https://qiita.com/blackpman/items/40a933c6b77db554e4ad を元にしています。)

### 新関数 「gprintf」

コードの解説等の前に、GBDKだけでなくゲームボーイの仕様として、**原則8px単位で描画が行われる**ということを知っておいてください。  
もちろん頑張ればそうじゃないことも出来ますが、8pxごとに「タイル」と呼ばれる描画パーツを用いて描画が行われるため、8x8の描画パーツ単位での描画指示を行います。

それをしっかり理解した上で、次に行ってみましょう。

### とりあえずサンプルプログラムを走らせてみる

```c
#include <gb/drawing.h>

int main() {
    UBYTE i,x,y;

    x = 2;
	y = 2;
        
    gotogxy(x, y);
    color(3, 0);
    gprintf("Hello World");
    
}
```

これをこのままコピーして、前ページのようにコンパイルしてみましょう。

出来た.gbファイルを実行してみると、このような画面が出てきますね。

![](https://i.imgur.com/8tbj0LB.png)  

前ページでやったprintfで出したものとは違い、文字が少し下がっています。 

さて、どうしてこのような画面になったのでしょうか。

#### include
最初にincludeしている`<gb/drawing.h>`は、ゲームボーイ用の描画命令を使うためのヘッダファイルです。stdio.hのように、書いとけばどうにかなるものだと思っておいてください。

#### 変数定義
次に`UBYTE`という型で定義されている`i` `x` `y`から見ていきましょう。  
よく使われる"int型"の変数というのは、±2,147,483,647を入れられる型となっています。  
同じようにUBYTE型というのは、符号なし(+のみ)の0~255までが入れられる型となっています。
なぜUBYTEを使っているかというとゲームボーイが8bit機だからという事になってくるのですが、そこの詳しいことは今回は省いて、次に進みます。  


#### gotogxy

最初の  

```c
x = 2;
y = 2;
```

ですが、一旦次の部分を説明してからにしましょう。 

```c
gotogxy(x, y);
```

この関数は、描画位置を指定するものです。  
Scratch等を触ったことがある人は、「ペンを移動する」と全く同じものだと思ってください。  
左上を原点として、x軸方向に何マス、y軸方向に何マス移動する、という感じです。

このgotogxyには、2つの引数が必要です。位置指定のためのxとyの座標ですね。  
このxとyの場所を、

```c
x = 2;
y = 2;
```
で指定しているのです。  
ではなぜ2と指定しただけで、前ページのHelloWorldと違い、位置が大きく変わったのでしょうか。

実はこれが先程も書いた、「8px単位で描画が行われる」からなのです。

先ほどの実行結果をスクリーンショットして、ペイントで8x8の枠を並べてみました。

![](https://i.imgur.com/caRukDQ.png)

たしかに8pxごとに文字が出ているのがわかるかと思います。  
でも、xとyを2としているのに、文字が出ているのは左上からそれぞれ3マス目ですね。  

実は、いちばん左上のマスの位置は**x:0 y:0**なのです。(配列と同じですね。)  
つまり、場所が0から数えられているため、"2"という場所は、0 1 2の3番目ということになり、"H"の文字が左から3マス目、上から3マス目の位置に描画されているのです

(ちなみに、ゲームボーイの画面解像度は160x144なので、8pxの塊が横に20（0～19）,縦に18（0～17）入ることになります。)

#### color

さて、次の文の説明です。

```c
color(3, 0);
```

colorというのは、そのまま色指定をする文です。  
ゲームボーイ(初代~ライトまでの白黒モデル)は、白黒4階調の液晶を搭載しています。そのため、0番から3番までの色の濃淡を指定することが出来ます。引数1つ目が文字の色、2つ目が背景の色となっています。数字が大きいほうが、色が濃くなっていきます。

実際に、以下のようなコードで、色の組み合わせを知ることが出来ます。

```c
#include <gb/drawing.h>

int main() {
    UBYTE x, y, i;

    gotogxy(0,0);
    gprintf("GB Color Test");
    
    gotogxy(0,5);
    gprintf("BG");
    
    for(i = 0; i <= 3; i++){
        gotogxy(3,i+5);
        gprintf("%d", i);
    }
    
    gotogxy(6,2);
    gprintf("FW");

    gotogxy(4,4);
    gprintf("0123");

    for (x=0; x<=3; x++){
        for (y=0; y<=3; y++){
            gotogxy(x+4, y+5);
            color(x, y);
            gprintf("a");
        }        
    }        
}
```

![](https://i.imgur.com/pUBf8bU.png)

#### gprintf

そして最後に、すでにわかるかとは思いますが、

```c
gprintf("Hello World");
```
は、"g"がついただけでほとんどprintfと同じ役割をしてくれる関数です。(\nを利用した改行はどうもできなさそうです。)


### 実践1
gotogxy、color、gprintfの使い方がわかったところで、実際にコードを書いてみましょう。

次のような表示をするプログラムを書いてみてください。 

![](https://i.imgur.com/muvILFc.png)

(補助枠線入り)  

![](https://i.imgur.com/SKlsGpZ.png)

[05. 実践1の解答例 ->](05.md)